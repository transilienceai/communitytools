---
model: sonnet
---

Execute comprehensive penetration testing using the Pentester orchestration agent with pentest skill knowledge base.

**CRITICAL WORKFLOW:**

1. **Invoke the pentest skill immediately** to load attack knowledge base:
```
/pentest skill loaded
```

2. **Deploy the Pentester Orchestrator Agent** using the Task tool:

The Pentester agent is a universal orchestration agent that DELEGATES all security testing to specialized sub-agents. It NEVER performs testing directly.

```
Deploy Pentester orchestration agent from: .claude/agents/pentester.md

The agent will:
- Analyze the user's penetration testing request
- Confirm authorization and scope
- Access pentest skill knowledge base (already loaded)
- Deploy 32+ specialized vulnerability discovery agents in parallel
- Monitor agent progress and discoveries
- Spawn additional agents based on findings (recursive testing)
- Aggregate findings and eliminate duplicates
- Verify all PoCs are working and tested
- Generate professional penetration testing reports
```

3. **Agent Deployment Pattern:**

```python
Task(
    subagent_type="Pentester",
    description="Penetration testing orchestration",
    prompt="""
    Execute penetration testing engagement using the Pentester orchestration agent.

    Agent location: .claude/agents/pentester.md
    Skill: /pentest (already loaded)

    User request: [PASS THE USER'S ORIGINAL REQUEST HERE]

    The Pentester agent will:
    1. Identify engagement type (web app, API, etc.)
    2. Confirm authorization and scope
    3. Deploy specialized agents:
       - SQL Injection Discovery Agent
       - XSS Discovery Agent
       - CSRF Discovery Agent
       - SSRF Discovery Agent
       - ... (all 32 web app agents)
    4. Monitor discoveries and spawn recursive agents
    5. Aggregate findings with PoC verification
    6. Generate professional reports (executive + technical)

    CRITICAL: The Pentester agent NEVER performs testing directly.
    It ONLY coordinates and delegates to specialized agents.
    """
)
```

4. **What the Pentester Agent Does:**

**✅ Orchestration Responsibilities:**
- Classify engagement type (web app, API, network, cloud, etc.)
- Verify authorization and scope
- Deploy ALL specialized vulnerability agents in parallel
- Monitor agent progress and outputs
- Spawn additional agents based on discoveries
- Aggregate findings and deduplicate
- Verify all PoCs are working and tested
- Identify exploit chains
- Generate professional reports following PTES/OWASP/SANS standards

**❌ What Pentester Agent NEVER Does:**
- Run testing tools (sqlmap, nmap, burp, etc.)
- Execute exploits or payloads
- Test vulnerabilities directly
- Perform reconnaissance itself

5. **32 Specialized Agents Available:**

The Pentester orchestrator delegates to these specialized agents:

**Injection (6 agents):**
- SQL Injection, NoSQL Injection, Command Injection, SSTI, XXE, LDAP/XPath

**Client-Side (6 agents):**
- XSS, CSRF, Clickjacking, CORS, DOM-Based, Prototype Pollution

**Server-Side (6 agents):**
- SSRF, HTTP Smuggling, File Upload, Path Traversal, Deserialization, Host Header

**Authentication (4 agents):**
- Auth Bypass, OAuth, JWT, Password Attacks

**API Security (4 agents):**
- GraphQL, REST API, WebSocket, Web LLM

**Business Logic (6 agents):**
- Business Logic Flaws, Race Conditions, Info Disclosure, Access Control, Cache Poisoning, Cache Deception

6. **Output Structure:**

Following `/.claude/OUTPUT_STANDARDS.md`:

```
findings/
├── findings.json                    # All vulnerabilities (machine-readable)
├── finding-001/                     # Individual finding folder
│   ├── report.md                    # Vulnerability report
│   ├── poc.py                       # VERIFIED, TESTED PoC script
│   ├── poc_output.txt              # Proof of successful execution
│   ├── workflow.md                  # Manual exploitation steps
│   └── description.md               # Attack overview
├── finding-002/
│   └── ...
└── ...

reports/
├── executive-summary.md             # 1-2 pages for C-level
├── technical-report.md              # Comprehensive for security teams
└── findings.json                    # Copy of master findings

evidence/
├── screenshots/                     # Visual evidence
├── http-logs/                       # HTTP request/response captures
└── videos/                          # Exploitation videos
```

7. **Report Standards:**

**CRITICAL**: All reports follow professional penetration testing standards from:
`.claude/skills/pentest/attacks/essential-skills/reporting/PROFESSIONAL_REPORT_STANDARD.md`

**Deliverables:**
- **Executive Report**: 1-2 pages, business impact, strategic recommendations
- **Technical Report**: Comprehensive findings, PoCs, remediation roadmap
- **JSON Output**: Machine-readable with CVSS, CWE, OWASP mappings

8. **PoC Verification Requirements:**

**MANDATORY**: Every vulnerability MUST have:
- ✅ Working PoC script (poc.py or poc.sh)
- ✅ Tested output (poc_output.txt with timestamp)
- ✅ Manual workflow (workflow.md)
- ✅ Attack description (description.md)

**Reject findings without verified PoCs** - theoretical vulnerabilities are NOT confirmed.

**Example Usage:**

```
User: Test https://example.com for vulnerabilities
Assistant: [Invokes /pentest skill, deploys Pentester agent]

Pentester Agent:
1. Classifies as web application engagement
2. Confirms authorization with user
3. Deploys all 32 web app agents in parallel
4. Monitors discoveries (e.g., SQL injection found → spawns auth bypass agent)
5. Aggregates findings, verifies PoCs
6. Generates executive + technical reports
```

**Key Principle:**

The `/pentest` command loads the knowledge base AND immediately deploys the Pentester orchestration agent, which then coordinates all specialized testing agents. The user gets a complete penetration testing engagement with professional deliverables.
