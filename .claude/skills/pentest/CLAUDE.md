# Pentest Skill - Claude Context

Auto-loaded when Claude works in this directory.

## What You Need to Know

**Purpose:** Help users with penetration testing tasks - learning attacks, finding payloads, explaining labs, generating reports using Playwright-based experimentation.

**Key documentation:**
- SKILL.md - Overview, methodology, and tool priorities
- LEARNED_TECHNIQUES.md - Novel techniques from real engagements (read first!)
- `attacks/[category]/[attack-type]/` - Detailed attack documentation
- `essential-skills/playwright-automation.md` - PRIMARY TOOL with step-by-step walkthroughs
- `essential-skills/methodology/` - PTES 7-phase testing lifecycle
- `essential-skills/reporting/` - Professional report templates
- `reference/WORKFLOW_ORCHESTRATION.md` - Multi-phase assessment patterns

## Directory Structure

**Root Level:**
- SKILL.md - Skill overview with polymethodology
- CLAUDE.md - This file (working context)

**Attack Categories** (`attacks/` directory):
- `injection/` - SQL, NoSQL, Command, SSTI, XXE, LDAP
- `client-side/` - XSS, CSRF, Clickjacking, CORS, DOM, Prototype Pollution (Playwright-based)
- `server-side/` - SSRF, HTTP Smuggling, File Upload, Path Traversal
- `authentication/` - Auth Bypass, OAuth, JWT, Password Attacks (Playwright workflows)
- `api-security/` - GraphQL, REST API, WebSockets, Web LLM
- `web-applications/` - Business Logic, Race Conditions, Access Control (Playwright testing)
- `network/` - Scanning, Sniffing, MITM, DNS, Wireless
- `system/` - Privilege Escalation, Exploit Development, Active Directory
- `cloud-containers/` - AWS, Azure, GCP, Kubernetes, Docker
- `essential-skills/` - Playwright Automation, Methodology, Reporting

**Attack Documentation Structure** (each attack type):
- **quickstart.md** - Rapid exploitation guide (5-15 min)
- **cheat-sheet.md** - Payload and command reference
- **portswigger-labs-complete.md** - Step-by-step lab solutions
- **methodology/definition/exploitation files** - Detailed technical documentation
- **resources.md** - Tools, links, training materials

## Tools Available

**PRIMARY: Playwright MCP Server** (Browser Automation):
- PRIMARY TOOL for web application penetration testing
- Use for all client-side testing (XSS, CSRF, DOM-based, Clickjacking)
- **CRITICAL**: Follow step-by-step experimentation walkthroughs
- Automated browser interactions and form filling
- Screenshot/video evidence capture
- JavaScript execution in browser context
- Network traffic and console log monitoring
- See `attacks/essential-skills/playwright-automation.md` for detailed usage

**HTTP Testing** (Server-Side):
- Use curl, Python requests, or httpx for server-side vulnerabilities
- SQL injection, command injection, SSRF, file upload, path traversal

**Experimentation Workflow**:
When testing hypotheses (Flaw Hypothesis Methodology - Step 3):
1. Navigate and Observe (playwright_navigate, playwright_snapshot)
2. Identify Interaction Points (find elements, selectors)
3. Test Hypothesis Step-by-Step (inject, screenshot, verify)
4. Validate Results (check indicators, capture evidence)
5. Experiment Variations (alternative payloads, edge cases)

## Common Tasks

**Explaining attacks** → Reference `attacks/[category]/[attack-type]/quickstart.md`

**Finding payloads** → Use `attacks/[category]/[attack-type]/cheat-sheet.md`

**Lab walkthroughs** → Use `portswigger-labs-complete.md` files

**Testing with Playwright** → Follow step-by-step walkthroughs in `essential-skills/playwright-automation.md`

**Learning paths**:
- **Beginners**: essential-skills/playwright-automation.md → client-side/xss/ → injection/sql-injection/
- **Bug bounty**: client-side/xss/, server-side/ssrf/, authentication/auth-bypass/
- **BSCP cert**: Focus on injection/, client-side/, server-side/, authentication/

**Report generation** → Use `attacks/essential-skills/reporting/PROFESSIONAL_REPORT_STANDARD.md`

## Methodology Quick Reference

**PTES 7-Phase Lifecycle**:
1. Pre-engagement (authorization, scope, RoE)
2. Intelligence gathering (passive/active recon)
3. Threat modeling (prioritize, TTPs, attack trees)
4. Vulnerability analysis (automated + manual OWASP WSTG)
5. Exploitation (PoC exploits, validate impact)
6. Post-exploitation (privilege escalation, lateral movement)
7. Reporting (executive + technical reports)

**Flaw Hypothesis Methodology** (Experimentation-Focused):
1. Information Gathering - Collect tech stack details
2. Hypothesis Generation - Predict vulnerabilities
3. **Experimentation** - Test with Playwright step-by-step walkthroughs
4. Generalization - Test similar flaws in related components
5. Analysis - Correlate findings, identify chains
6. Reporting - Document hypotheses, experiments, results

## Critical Rules

**AUTHORIZED TESTING ONLY**:
- All techniques MUST only be used in authorized environments
- Always emphasize legal/ethical considerations
- Remind users to get written authorization before testing
- ✅ PortSwigger Academy, HackTheBox, TryHackMe, bug bounty (in-scope), contracted pentests
- ❌ Never test without authorization, exceed scope, cause damage

**Quality Standards**:
- Map findings to OWASP Top 10, MITRE ATT&CK, CWE, CVSS v3.1
- Every vulnerability MUST have verified PoC (poc.py + poc_output.txt)
- Use Playwright for evidence collection (screenshots, videos, network logs)
- Follow OUTPUT_STANDARDS.md for professional reporting

**Playwright Experimentation**:
- ALWAYS use step-by-step walkthroughs during hypothesis testing
- Capture evidence at each step (baseline, injection, result, validation)
- Document failed attempts (important for learning)
- Use playwright_screenshot, playwright_evaluate, playwright_network_requests

## Quick Navigation

**Need to test XSS?** → `attacks/client-side/xss/` + `essential-skills/playwright-automation.md`

**Need SQL injection payloads?** → `attacks/injection/sql-injection/cheat-sheet.md`

**Need methodology?** → `attacks/essential-skills/methodology/`

**Need to write reports?** → `attacks/essential-skills/reporting/PROFESSIONAL_REPORT_STANDARD.md`

**Need Playwright walkthroughs?** → `attacks/essential-skills/playwright-automation.md`

## Usage Pattern

1. Start with quickstart guide for rapid learning
2. Reference cheat sheets for specific payloads
3. Follow Playwright walkthroughs for experimentation
4. Use methodology files for structured testing
5. Capture evidence with Playwright screenshots/videos
6. Generate professional reports with OUTPUT_STANDARDS.md
