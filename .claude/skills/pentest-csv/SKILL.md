---
name: CSV Pentest
description: Launch penetration testing agents for all assets in a CSV scope file
userInvocable: true
---

# CSV Pentest Skill

Automatically launch penetration testing for all assets defined in a HackerOne-style CSV scope file.

## Usage

```
/pentest-csv <csv_file_path>
```

Or with program guidelines:

```
/pentest-csv <csv_file_path> --guidelines "<program guidelines text>"
```

## What This Does

1. **Reads the CSV scope file** you provide
2. **Parses all in-scope assets** from the CSV
3. **Launches a Pentester agent for each asset** in parallel
4. **Generates HackerOne submission reports** for all findings
5. **Saves results** to `outputs/[program_name]/`

## CSV Format

Expected CSV format (HackerOne export format):

```csv
identifier,asset_type,instruction,eligible_for_bounty,eligible_for_submission,max_severity
example.com,URL,,true,true,critical
api.example.com,URL,,true,true,critical
*.example.com,WILDCARD,,true,true,critical
```

Required columns:
- `identifier` - The asset URL, domain, or identifier
- `asset_type` - Type of asset (URL, WILDCARD, API, etc.)
- `eligible_for_submission` - Must be "true" to be tested
- `max_severity` - Maximum severity level
- `instruction` - Optional testing instructions

## Examples

### Example 1: Basic Usage

```
/pentest-csv scopes_for_unico_idtech.csv
```

This will:
- Read the CSV file
- Ask you for program guidelines
- Launch pentester agents for all assets
- Generate reports

### Example 2: With Guidelines

```
/pentest-csv scopes_for_unico_idtech.csv --guidelines "Test for XSS, SQLi, SSRF (no internal scanning), JWT vulnerabilities, IDOR, RCE (harmless only). Out of scope: Clickjacking, Self-XSS, Rate limiting. Required headers: X-HackerOne-Research, User-Agent."
```

### Example 3: With File Guidelines

```
/pentest-csv scopes_for_program.csv --guidelines-file program_policy.txt
```

## Program Guidelines

You should provide the following information:

**In-Scope Vulnerabilities:**
- What vulnerability types to test for
- Any special testing criteria

**Out-of-Scope:**
- What NOT to test
- What vulnerabilities are excluded

**Testing Rules:**
- Required headers
- Rate limits
- Prohibited actions
- Testing windows

**Submission Requirements:**
- Proof-of-concept requirements
- OWASP risk rating requirements

## Output Structure

**Format**: Bug Bounty (Platform Submissions)

See `/.claude/OUTPUT_STANDARDS.md` for complete specification.

**Structure**: `outputs/<program>/<asset>/` with consolidated reports and HackerOne-ready submissions in `reports/submissions/`

## What Gets Generated

For each vulnerability found:

1. **Detailed HackerOne Report** with:
   - Summary and description
   - CVSS score and severity
   - Step-by-step reproduction
   - HTTP request/response evidence
   - Impact analysis
   - Remediation recommendations

2. **Findings Summary** with:
   - Count by severity
   - Estimated bounty ranges
   - Priority order for submission

3. **Submission Guide** with:
   - How to submit to HackerOne
   - Submission order
   - Response templates
   - Best practices

## Workflow

When you run `/pentest-csv`:

1. **CSV Parsing**
   - Reads your CSV file
   - Extracts all eligible assets
   - Shows you the scope

2. **Guidelines Collection** (if not provided)
   - Asks for program rules
   - Asks for in-scope vulnerabilities
   - Asks for out-of-scope items
   - Asks for testing restrictions

3. **Agent Deployment**
   - Launches Pentester agent for each asset
   - All agents run in parallel
   - Shows progress in real-time

4. **Results Collection**
   - Waits for all agents to complete
   - Aggregates findings
   - Deduplicates vulnerabilities

5. **Report Generation**
   - Creates HackerOne submission reports
   - Generates findings summary
   - Creates submission guide

## Tips

- **Run multiple programs**: You can run this command multiple times for different programs
- **Parallel testing**: All assets are tested in parallel for speed
- **Background mode**: Agents run in the background so you can continue working
- **Check progress**: Use `/tasks` to see agent progress
- **Resume if interrupted**: If stopped, simply run the command again

## Example Session

```bash
> /pentest-csv scopes_for_unico_idtech.csv

üìã Reading CSV scope file...
‚úÖ Found 11 assets in scope:
   - sdk-h1.unico.io (URL)
   - api.id.unico.app (URL)
   - transactions.transactional.unico.app (URL)
   - *.unico.io (WILDCARD)
   - ... and 7 more

‚ùì Please provide program guidelines (or press Enter to be prompted):
> Test for XSS, SQLi, SSRF, JWT, IDOR, RCE. No service disruption.

üöÄ Launching 11 pentester agents in parallel...
‚úÖ Agent 1/11: sdk-h1.unico.io - Started
‚úÖ Agent 2/11: api.id.unico.app - Started
‚úÖ Agent 3/11: transactions.transactional.unico.app - Started
...

‚è≥ Testing in progress (estimated 2-4 hours)
   Use /tasks to check progress

[4 hours later]

‚úÖ All agents complete!

üìä Results:
   - 8 vulnerabilities found
   - 2 Critical, 4 High, 2 Medium
   - Estimated bounty: $18,000 - $44,000

üìÅ Reports saved to: outputs/unico_idtech/
   - FINDINGS_SUMMARY.md
   - reports/submissions/ (8 HackerOne reports)
   - HACKERONE_SUBMISSION_GUIDE.md

üéØ Next: Review reports and submit to HackerOne
```

## Advanced Options

### Specify Output Directory

```
/pentest-csv scopes.csv --output /custom/path/
```

### Test Specific Assets Only

```
/pentest-csv scopes.csv --assets "example.com,api.example.com"
```

### Skip Asset Types

```
/pentest-csv scopes.csv --skip-types "WILDCARD,OTHER"
```

### Custom Testing Focus

```
/pentest-csv scopes.csv --focus "PRIMARY:Liveness,SECONDARY:Web"
```

---

## Technical Details

This skill:
1. Invokes the **HackerOne Bug Bounty Hunter agent**
2. Which launches multiple **Pentester agents** in parallel
3. Each Pentester agent uses specialized vulnerability agents
4. Results are aggregated and formatted for HackerOne

All testing follows:
- ‚úÖ Program-specific rules
- ‚úÖ Ethical hacking principles
- ‚úÖ HackerOne guidelines
- ‚úÖ Responsible disclosure practices

---

**Ready to start? Just run:**

```
/pentest-csv <your_scope_file.csv>
```
