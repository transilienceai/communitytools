---
name: pentest
description: Comprehensive penetration testing skill which coordinates discovery, enumeration, exploitation, and post-exploitation by orchestrating parallel specialized agents for each attack phase.
---

# Penetration Testing Skill

## Purpose

This skill enables Claude to orchestrate end-to-end penetration testing operations by deploying multiple specialized agents to assess technical controls, uncover vulnerabilities, and validate exploitability through automated and manual testing.

## Core Capabilities

### Multi-Agent Penetration Testing Architecture

The penetration testing process uses **8 specialized agents** plus **5 inventory mapping agents** that work together:

1. **Reconnaissance Agent**
   - Gathers information about target assets, domains, IPs, technologies, and open-source intelligence (OSINT).

2. **Enumeration Agent**
   - Conducts in-depth scanning for open ports, services, versions, directories, subdomains, and asset exposures.

3. **Vulnerability Scanner Agent**
   - Identifies security issues in services, web applications, and infrastructure through automated, tool-based vulnerability scanning.

4. **Exploitation Agent**
   - Attempts exploitation of discovered vulnerabilities using public exploits, Metasploit modules, or custom payloads.

5. **Credential & Access Tester Agent**
   - Attempts credential brute-forcing, default credentials, password spraying, and privilege escalation techniques.

6. **Post-Exploitation Agent**
   - Evaluates lateral movement, persistence, sensitive data access, and impact after initial foothold is achieved.

7. **Reporting Agent**
   - Correlates, deduplicates, and summarizes findings, mapping them to risk ratings and technical evidence for reporting.

8. **Coordinator & Orchestrator Agent**
   - Orchestrates the engagement, feeds outputs between agents, tracks scope, and ensures all testing phases are covered without overlap.

### Inventory Mapping Agents (Web Application Reconnaissance)

Prior to vulnerability testing, **5 specialized inventory agents** perform comprehensive application mapping:

0. **inventory-software-catalog** (Phase 0: Software Inventory)
   - Identifies and catalogs all application dependencies, frameworks, libraries, and versions
   - Generates Software Bill of Materials (SBOM) for CVE testing
   - Detects technology stack across backend and frontend

1. **inventory-directory-scanner** (Phase 1: Active Scanning - Directories/Files)
   - Runs comprehensive active scanning tools: ffuf, gobuster, nikto, ZAP spider
   - Discovers directories, files, backups, configuration files, and hidden resources
   - Enumerates admin panels and development artifacts

2. **inventory-api-discovery** (Phase 2: API Discovery - REST/GraphQL/SOAP)
   - Specialized API endpoint discovery for REST, GraphQL, SOAP, and WebSocket APIs
   - Locates API documentation (Swagger, OpenAPI, WSDL, Postman collections)
   - Enumerates API versions, methods, and parameters

3. **inventory-javascript-mapper** (Phase 3: JavaScript & SPA Discovery - Client-Side Routes)
   - Uses headless browser automation to discover JavaScript-rendered pages
   - Maps SPA routes (React, Vue, Angular) and client-side routing
   - Finds dynamically-loaded scripts and hidden features invisible to standard scanners
   - Analyzes browser storage (localStorage, sessionStorage) and WebSocket connections

4. **inventory-surface-analyzer** (Phase 4: Attack Surface Analysis - Consolidation)
   - Analyzes all discovered endpoints, directories, APIs, and JavaScript routes
   - Categorizes attack surfaces by type and risk level
   - Creates comprehensive testing checklists organized by function and priority
   - Maps findings to OWASP Top 10 categories

**Inventory Workflow:**
- Can launch all inventory agents in parallel for fastest full coverage
- Or launch specific agents based on application type (traditional web app, SPA, API-only)
- Inventory phase completes before vulnerability testing begins
- All findings feed into subsequent exploitation and testing phases

## Operational Rules

- Agents operate in parallel where possible for efficiency, but maintain strict engagement sequencing (recon > enum > vuln > exploit > post-exploit).
- Always honor defined engagement scope, rules of engagement, and safety requirements.
- All findings must be evidence-based with logs, screenshots, or payload/output files.
- Store all scripts, logs, artifacts, and generated reports under `outputs/pentest/<customer_name>/` using the required directory hierarchy.

## Summary Workflow

1. Begin with Reconnaissance Agent to define targets.
2. Loop through Enumeration, Vulnerability Scanning, and Exploitation with coordinated data sharing.
3. Conduct access and privilege escalation testing as applicable.
4. Perform post-exploitation analysis and impact assessment.
5. Reporting Agent generates actionable final report; Coordinator ensures nothing is missed.

## When to Deploy

- During assessments of external, internal, web, application, or cloud environments for vulnerability, risk, and exploitability.
- At scheduled intervals or on-demand to validate security posture or after major changes.

## Output Expectations

- Full scope technical pentest report(s) in `reports/`
- Targeted exploit and scan scripts in `scripts/`
- Raw logs, tool outputs, and evidence in `raw/`
- Intermediate data and partial results in `sections/`
- All files always under `outputs/pentest/<customer_name>/`



## Directory Structure and File Organization

All agents must follow this standardized directory structure:

```
outputs/<agent_name>/<customer_name>/
├── scripts/          # Processing scripts, automation code (.py files)
├── reports/          # Final markdown reports (_final.md files)
├── raw/              # Raw data outputs (JSON, CSV files)
└── sections/         # Intermediate/temporary files (optional)
```

### Critical Rules for File Creation

**Scripts and Code:**
- **ALWAYS** create Python scripts in `outputs/<agent_name>/<customer_name>/scripts/`
- **NEVER** create scripts in the root directory
- Example: `outputs/structured_data_extractor/breach_news/scripts/extract_breach_data.py`
