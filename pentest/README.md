# ğŸ”’ Claude Code Pentest Framework

> **Autonomous Multi-Agent Penetration Testing Framework powered by Claude AI**

**Part of [Transilience AI Community Tools](https://github.com/transilienceai/communitytools) - Open-source security tools from [www.transilience.ai](https://www.transilience.ai)**

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Claude Code](https://img.shields.io/badge/Claude-Code-7C3AED)](https://claude.ai/code)
[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](http://makeapullrequest.com)

A comprehensive, AI-powered penetration testing framework that orchestrates **20+ specialized security testing agents** to perform automated vulnerability assessments, exploitation testing, and comprehensive security analysis.

---

## ğŸ“º Demo Videos

Watch the framework in action performing autonomous security testing:

### ğŸ—ºï¸ Application Mapping & Inventory

**[â–¶ï¸ Watch Demo](https://www.loom.com/share/d172a4cf9bbb4f4caef63204dc09f5c1)**

This video demonstrates the 5-phase application mapping process where the framework autonomously discovers directories, APIs, JavaScript routes, and generates a complete attack surface analysis. Watch as multiple inventory agents work in parallel to build a comprehensive map of the target application before vulnerability testing begins.

---

### ğŸ”“ CVE Testing & Exploitation

**[â–¶ï¸ Watch Demo](https://www.loom.com/share/4eb98e77a2fa486eae5aa0f3a56c37f0)**

See the CVE testing agent in action as it researches known vulnerabilities for Apache Struts 2.3.1.2, locates public exploits, and validates exploitability. The framework automatically identifies CVE-2013-2251 (CVSS 9.3) and generates visual proof of remote code execution with screenshots and comprehensive remediation guidance.

---

### ğŸ’¼ Business Logic Testing

**[â–¶ï¸ Watch Demo](https://www.loom.com/share/990e51e9bc294d5599ab5da9588f31f3)**

Watch how the framework identifies complex business logic vulnerabilities that traditional scanners miss. This demo shows the detection of price manipulation, negative quantity orders, conservation law violations, and workflow bypass attacks with detailed impact analysis and proof-of-concept code.

---

### âš¡ Race Condition Testing

**[â–¶ï¸ Watch Demo](https://www.loom.com/share/b4fe3e41bde1468aa009140548f20b87)**

See advanced concurrency testing in action including duplicate transaction processing, TOCTOU file access attacks, and HTTP/2 multiplexing races. The framework executes 500+ concurrent requests to identify race conditions that could lead to financial fraud and data integrity violations.

---

### ğŸ’‰ SQL Injection Testing

**[â–¶ï¸ Watch Demo](https://www.loom.com/share/4081ac2040ca4b93a5d0bfb953444759)**

Watch comprehensive SQL injection testing across error-based, boolean blind, time-based, and UNION-based techniques. The demo showcases the framework's false-positive prevention methodology using baseline comparison and strict detection criteria to ensure accurate results.

---

## ğŸŒŸ Features

### ğŸ¤– **20+ Specialized Testing Agents**
Each agent is an expert in a specific vulnerability class, working autonomously to:
- Discover vulnerabilities
- Validate exploitability
- Generate evidence packages
- Provide remediation guidance

### ğŸ¯ **OWASP Top 10 Coverage**
- âœ… SQL Injection (all types: error, boolean, time, UNION-based)
- âœ… Cross-Site Scripting (XSS: reflected, stored, DOM-based)
- âœ… Server-Side Request Forgery (SSRF)
- âœ… XML External Entity (XXE)
- âœ… Insecure Direct Object References (IDOR)
- âœ… Broken Function Level Authorization (BFLA)
- âœ… Mass Assignment
- âœ… Path Traversal & LFI/RFI
- âœ… Race Conditions
- âœ… Business Logic Vulnerabilities
- âœ… Authentication & JWT Security
- âœ… Cross-Site Request Forgery (CSRF)
- âœ… Insecure File Uploads
- âœ… CVE Testing & Exploitation

### ğŸ—ºï¸ **5-Phase Application Mapping**
Before vulnerability testing, comprehensive reconnaissance is performed:
1. **Software Inventory** - Technology stack detection & SBOM generation
2. **Directory Enumeration** - Active scanning with ffuf, gobuster, nikto
3. **API Discovery** - REST, GraphQL, SOAP, WebSocket endpoint mapping
4. **JavaScript Analysis** - SPA routes, dynamic content, client-side vulnerabilities
5. **Attack Surface Analysis** - Risk-based testing checklist generation

### ğŸ“Š **Professional Reporting**
- CVSS v3.1 scoring for all findings
- Executive summaries with risk prioritization
- Technical evidence packages (screenshots, logs, payloads)
- False-positive correction with manual validation
- Comprehensive final reports in standardized format

### ğŸ” **Accurate Detection**
- Baseline comparison methodology
- Strict, context-aware vulnerability detection
- Manual verification for claimed vulnerabilities
- Zero false-positive tolerance

---

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Claude Code Orchestrator                   â”‚
â”‚               (Multi-Agent Coordination Layer)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚               â”‚               â”‚
       â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Inventory  â”‚ â”‚Vulnerabilityâ”‚ â”‚   Exploit   â”‚
â”‚   Agents    â”‚ â”‚   Testers   â”‚ â”‚   Agents    â”‚
â”‚   (5)       â”‚ â”‚   (14)      â”‚ â”‚   (1)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚               â”‚               â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Report Engine  â”‚
              â”‚  Evidence DB    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Workflow

1. **Discovery Phase** - Inventory agents map the complete attack surface
2. **Analysis Phase** - Vulnerability testers run in parallel across OWASP categories
3. **Exploitation Phase** - CVE tester validates exploitability of discovered vulnerabilities
4. **Reporting Phase** - Comprehensive reports generated with CVSS scoring and evidence

---

## ğŸš€ Quick Start

### Prerequisites

- **[Claude Code](https://claude.ai/code)** - Required for running the framework
- **Security Testing Tools** (optional but recommended for enhanced capabilities):
  - `ffuf`, `gobuster`, `nikto` - Directory and file enumeration
  - `sqlmap` - Advanced SQL injection testing
  - `nuclei` - CVE and vulnerability scanning
  - `nmap` - Port scanning and service detection

**Note:** Claude Code handles the execution environment. No Python dependencies need to be installed manually - Claude will manage any required packages during agent execution.

### Installation

1. **Clone this repository to your working directory:**

```bash
git clone https://github.com/transilienceai/communitytools.git
cd communitytools/pentest
```

2. **Verify the framework structure:**

```bash
# List available agents
ls .claude/agents/

# List available skills
ls .claude/skills/
```

3. **That's it!** Claude Code will automatically detect and use the agents and skills in this directory.

### Basic Usage

**Start Claude Code and activate the pentest skill:**

```bash
claude
```

**In Claude Code, run a comprehensive assessment:**

```
Can you perform a comprehensive web application security assessment on http://target-app.com:8080?
```

**Or test specific vulnerability classes:**

```
Please test http://target-app.com for SQL injection vulnerabilities
```

```
Run XSS testing on http://target-app.com using the xss-tester agent
```

**View generated reports:**

```bash
# All comprehensive reports are in:
cat outputs/COMPREHENSIVE_FINAL_REPORTS_INDEX.md

# Specific vulnerability report:
cat outputs/sql-injection/target/reports/sql-injection-tester_comprehensive_final_report.md
```

---

## ğŸ“š Available Agents

### ğŸ” Inventory & Reconnaissance Agents

| Agent | Purpose | Outputs |
|-------|---------|---------|
| `inventory-software-catalog` | Detects technology stack, frameworks, versions | SBOM, CVE feed |
| `inventory-directory-scanner` | Active directory/file enumeration | Discovered paths, admin panels |
| `inventory-api-discovery` | REST/GraphQL/SOAP endpoint mapping | API schema, endpoints |
| `inventory-javascript-mapper` | SPA routes, dynamic content analysis | Client-side routes, WebSocket |
| `inventory-surface-analyzer` | Attack surface risk analysis | Testing checklists by priority |

### ğŸ›¡ï¸ Vulnerability Testing Agents

| Agent | OWASP Category | Tests |
|-------|----------------|-------|
| `sql_injection` | A03:2021 - Injection | Error, Boolean, Time, UNION-based SQLi |
| `xss-tester` | A03:2021 - Injection | Reflected, Stored, DOM-based XSS |
| `xxe` | A05:2021 - Security Misconfiguration | Classic XXE, SSRF via XXE, Billion Laughs |
| `ssrf-tester` | A10:2021 - SSRF | Localhost, cloud metadata, internal services |
| `idor-tester` | A01:2021 - Broken Access Control | Horizontal/vertical privilege escalation |
| `bfla_tester` | A01:2021 - Broken Access Control | Function-level authorization bypass |
| `mass_assignment` | A03:2021 - Injection | Parameter pollution, unauthorized fields |
| `path_traversal_disclosure` | A01:2021 - Broken Access Control | LFI, RFI, directory traversal |
| `authentication_jwt` | A07:2021 - Auth Failures | JWT forgery, algorithm confusion |
| `csrf` | A01:2021 - Broken Access Control | State-changing CSRF |
| `insecure_file_uploads` | A04:2021 - Insecure Design | RCE via upload, stored XSS |
| `race_conditions` | A04:2021 - Insecure Design | TOCTOU, concurrent state manipulation |
| `business_logic` | A04:2021 - Insecure Design | Workflow bypass, invariant violations |
| `cve-tester` | Known Vulnerabilities | CVE exploitation, version-specific attacks |

### ğŸ” Specialized Skills

| Skill | Purpose |
|-------|---------|
| `common-appsec-patterns` | Coordinates testing across multiple OWASP categories |
| `web-application-mapping` | Full application reconnaissance coordinator |
| `web-application-pentesting` | End-to-end pentest orchestration |
| `cve-testing` | CVE research and exploitation coordinator |
| `domain-assessment` | Subdomain discovery and port scanning |

---

## ğŸ“– Usage Examples

### Example 1: Full Web Application Assessment

```
I need a complete security assessment of https://webapp.example.com

Please:
1. Map the entire application (endpoints, APIs, JavaScript routes)
2. Test for all OWASP Top 10 vulnerabilities
3. Generate comprehensive reports with evidence
```

**Expected Output:**
- 5 inventory reports (software, directories, APIs, JS, attack surface)
- 14 vulnerability testing reports
- 1 master index with all findings
- Evidence packages (screenshots, logs, payloads)

### Example 2: Targeted SQL Injection Testing

```
Test https://api.example.com/v1/users for SQL injection vulnerabilities
```

**Expected Output:**
- Error-based SQLi tests
- Boolean blind SQLi tests
- Time-based blind SQLi tests
- UNION-based SQLi tests
- Screenshot evidence
- Comprehensive report with CVSS scoring

### Example 3: CVE Testing Against Known Vulnerabilities

```
The target is running Apache Struts 2.3.1.2. Test for known CVEs.
```

**Expected Output:**
- CVE research for Struts 2.3.1.2
- Exploitation attempts for S2-001, S2-016, S2-045, S2-057, S2-061
- Visual proof of exploitation
- Remediation guidance

---

## ğŸ“ Directory Structure

```
pentest/
â”œâ”€â”€ .claude/
â”‚   â”œâ”€â”€ agents/              # 20+ specialized testing agents
â”‚   â”‚   â”œâ”€â”€ sql_injection.md
â”‚   â”‚   â”œâ”€â”€ xss-tester.md
â”‚   â”‚   â”œâ”€â”€ cve-tester.md
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ skills/              # Orchestration skills
â”‚   â”‚   â”œâ”€â”€ web-application-pentesting/
â”‚   â”‚   â”œâ”€â”€ common-appsec-patterns/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ CLAUDE.md           # Framework configuration
â”œâ”€â”€ outputs/                 # All test results
â”‚   â”œâ”€â”€ COMPREHENSIVE_FINAL_REPORTS_INDEX.md
â”‚   â”œâ”€â”€ sql-injection/
â”‚   â”‚   â””â”€â”€ target/
â”‚   â”‚       â”œâ”€â”€ scripts/    # Testing scripts
â”‚   â”‚       â”œâ”€â”€ reports/    # Final reports
â”‚   â”‚       â”œâ”€â”€ raw/        # JSON results
â”‚   â”‚       â””â”€â”€ screenshots/ # Evidence
â”‚   â”œâ”€â”€ xss-tester/
â”‚   â”œâ”€â”€ cve-tester/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ README.md               # This file
â””â”€â”€ LICENSE                 # MIT License
```

---

## ğŸ¯ Report Format

All agents generate standardized comprehensive reports:

**Naming Convention:** `<agent_name>_comprehensive_final_report.md`

**Report Sections:**
1. **Executive Summary** - High-level findings and risk assessment
2. **Vulnerabilities Found** - Detailed technical findings with CVSS scores
3. **Secure Findings** - What was tested but found secure
4. **Testing Methodology** - Techniques and tools used
5. **Impact Assessment** - Business and technical impact
6. **Evidence Package** - Screenshots, logs, payloads, proof-of-concept code
7. **Remediation Recommendations** - Prioritized fix guidance

**Example Report Location:**
```
outputs/sql-injection/172.174.98.16_8080/reports/sql-injection-tester_comprehensive_final_report.md
```

---

## ğŸ”¬ Testing Methodology

### False Positive Prevention

The framework implements rigorous validation to ensure accuracy:

1. **Baseline Comparison** - Compare responses against normal application behavior
2. **Strict Detection** - Use service-specific error messages, not generic keywords
3. **Context-Aware Matching** - Avoid false positives from application content
4. **Manual Verification** - Secondary validation for all claimed vulnerabilities
5. **Documentation** - All corrections documented in final reports

**Example: SQL Injection Detection**
```python
# âŒ INCORRECT (too broad)
if "NULL" in response.text:
    vulnerable = True

# âœ… CORRECT (strict + baseline)
union_indicators = ["5.7.33-MySQL", "PostgreSQL 12.3"]
if indicator in response and indicator not in baseline:
    vulnerable = True
```

### Safe Testing Principles

- **Read-only operations** - No destructive testing
- **Scoped testing** - Only test authorized targets
- **Rate limiting** - Respect application performance
- **Evidence collection** - All findings backed by proof
- **Remediation focus** - Actionable guidance provided

---

## ğŸ› ï¸ Configuration

### Custom Target Configuration

Edit `.claude/CLAUDE.md` to customize:
- Target scope and rules of engagement
- Output directory preferences
- Testing intensity levels
- Agent selection and ordering

### Agent Customization

Each agent can be customized by editing its markdown file in `.claude/agents/`:

```markdown
---
name: sql_injection
description: SQL injection vulnerability tester
---

# Custom instructions for this agent
- Test only specified parameters
- Use custom payloads from ./payloads/
- Generate screenshots for all findings
```

---

## ğŸ¤ Contributing

We welcome contributions! Here's how you can help:

### Adding New Agents

1. Create agent file: `.claude/agents/your_agent.md`
2. Follow the agent template structure
3. Add tests and documentation
4. Submit a pull request

### Improving Detection Logic

1. Fork the repository
2. Create a feature branch: `git checkout -b feature/better-detection`
3. Test your improvements
4. Document false positive corrections
5. Submit a pull request

### Reporting Issues

Found a bug or false positive?
- Open an issue with reproduction steps
- Include target application details (if public)
- Attach relevant logs and screenshots

---

## ğŸ“ License

This project is licensed under the **MIT License** - see the [LICENSE](LICENSE) file for details.

```
MIT License

Copyright (c) 2025 Transilience AI

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

---

## âš ï¸ Legal Disclaimer

**IMPORTANT: This tool is designed for authorized security testing only.**

- âœ… **Legal Use:** Penetration testing authorized by the target owner
- âœ… **Legal Use:** Security research on your own applications
- âœ… **Legal Use:** CTF competitions and security training labs
- âœ… **Legal Use:** Bug bounty programs with proper scope

- âŒ **Illegal Use:** Testing applications without written authorization
- âŒ **Illegal Use:** Exploiting vulnerabilities for malicious purposes
- âŒ **Illegal Use:** Accessing data you're not authorized to access

**Users are solely responsible for compliance with all applicable laws and regulations.**

The authors and contributors of this framework:
- Do NOT condone illegal hacking or unauthorized security testing
- Are NOT responsible for misuse of this software
- Provide this tool for educational and authorized testing purposes only

**Always obtain written permission before testing any system you do not own.**

---

## ğŸ™ Acknowledgments

- **Claude AI** by Anthropic - For making autonomous security testing possible
- **OWASP** - For vulnerability taxonomy and testing guidance
- **Security Community** - For tools, techniques, and knowledge sharing

---

## ğŸ“ Support

- **Issues:** [GitHub Issues](https://github.com/transilienceai/communitytools/issues)
- **Discussions:** [GitHub Discussions](https://github.com/transilienceai/communitytools/discussions)
- **Website:** [transilience.ai](https://transilience.ai)

---

## ğŸ—ºï¸ Roadmap

- [ ] Add video tutorials and demos
- [ ] Expand to mobile application testing
- [ ] API-only testing mode
- [ ] Cloud security posture assessments (AWS, Azure, GCP)
- [ ] Kubernetes security testing
- [ ] Container security scanning
- [ ] CI/CD integration (GitHub Actions, GitLab CI)
- [ ] Real-time vulnerability dashboard
- [ ] Custom payload libraries
- [ ] Multi-target parallel testing

---

<div align="center">

**Made with â¤ï¸ by [Transilience AI](https://transilience.ai)**

â­ **Star this repo if you find it useful!** â­

[Report Bug](https://github.com/transilienceai/communitytools/issues) Â· [Request Feature](https://github.com/transilienceai/communitytools/issues) Â· [Documentation](https://github.com/transilienceai/communitytools/wiki)

</div>
