# Test Plan Format

Template for presenting test plans to users for approval.

## Structure

```markdown
# Penetration Test Plan

## Target
- URL: https://example.com
- Engagement: example-com-2025-01
- Scope: All endpoints under /api/*, /admin/*

## Reconnaissance Findings
- Login form (2 parameters: username, password)
- API endpoints: /api/users, /api/orders
- File upload: /upload/profile-picture
- Admin panel detected: /admin
- Technologies: Node.js, PostgreSQL, React

## Proposed Executors (15 total)

### High Priority (Always Deploy - 4)
- **SQL Injection Executor** → Login form, API endpoints
- **XSS Executor** → All input fields, search functionality
- **SSRF Executor** → API endpoints, webhook functionality
- **Auth Bypass Executor** → Login form, admin panel

### Attack Surface Specific (11)
- **CSRF Executor** → State-changing forms, API endpoints
- **File Upload Executor** → Profile picture upload
- **JWT Executor** → API authentication tokens
- **Path Traversal Executor** → File operations
- **NoSQL Injection Executor** → Database queries
- **Command Injection Executor** → System operations
- **GraphQL Executor** → GraphQL API endpoints
- **REST API Executor** → REST endpoints
- **CORS Executor** → Cross-origin requests
- **Clickjacking Executor** → Frame-embeddable pages
- **Prototype Pollution Executor** → JavaScript parsing

## Testing Approach
1. Deploy all 15 executors in parallel (single Task call)
2. Each executor follows 4-phase workflow: Recon → Experiment → Test → Verify
3. Monitor progress with non-blocking checks
4. Recursive spawning: If new attack surface discovered, deploy additional executors
5. Aggregate findings after all executors complete

## Estimated Resources
- Executors: 15 agents running in parallel
- Duration: 2-4 hours (depends on target complexity)
- Request rate: Respects rate limits (10 req/s default)
- Output: Activity logs + finding folders + aggregated report

## Approval Options
- **Approve**: Proceed with proposed plan
- **Modify**: Adjust executor list or priorities
- **Cancel**: Do not proceed with testing
```

## Presentation Method

Use AskUserQuestion with these options:

**Question**: "I've created a test plan based on reconnaissance. Review the plan above."

**Options**:
1. "Approve plan - proceed with testing" (Recommended)
2. "Modify executor list"
3. "Cancel testing"

## Modification Handling

If user selects "Modify executor list":
1. Ask which executors to add/remove
2. Update plan
3. Re-present for approval
4. Repeat until approved or cancelled

## Example Questions

```python
AskUserQuestion(
    questions=[{
        "question": "Approve this penetration test plan?",
        "header": "Test Plan",
        "multiSelect": False,
        "options": [
            {
                "label": "Approve - proceed with 15 executors (Recommended)",
                "description": "Deploy all executors and begin testing"
            },
            {
                "label": "Modify executor list",
                "description": "Adjust which executors to deploy"
            },
            {
                "label": "Cancel testing",
                "description": "Do not proceed with penetration testing"
            }
        ]
    }]
)
```

## Critical Rules

- Always present plan before deploying executors
- Never proceed without explicit approval
- Log plan creation and approval decision
- If user cancels, stop immediately and log cancellation
- If user requests modifications, iterate until approved
