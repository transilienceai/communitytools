---
name: pentest
description: Penetration testing orchestrator that coordinates specialized attack agents. Provides attack indexes, methodology frameworks, and documentation. Execution delegated to specialized agents (SQL Injection, XSS, SSRF, etc.). Use for engagement planning and attack coordination.
---

# Penetration Testing Orchestrator

**Role**: Attack coordination and documentation index. **Does NOT execute attacks directly**.

**Quick reference**: `/AGENTS.md` for payloads, CVSS scoring, methodologies
**Orchestration**: `pentester` agent coordinates multi-phase testing

## What This Skill Does

1. **Attack Index** - References 50+ attack types with documentation paths
2. **Methodology Frameworks** - PTES, OWASP WSTG, MITRE ATT&CK, Flaw Hypothesis
3. **Coordination** - Guides pentester agent to deploy specialized attack agents
4. **Documentation** - PortSwigger labs, cheat sheets, quickstarts per attack

**Execution**: Delegated to specialized agents (SQL Injection Agent, XSS Agent, SSRF Agent, etc.)

## Attack Categories Index

### Injection (6 types) → `attacks/injection/`
- SQL Injection | NoSQL Injection | Command Injection
- SSTI | XXE | LDAP/XPath
**Agent**: `SQL Injection Discovery Agent`, `NoSQL Injection Discovery Agent`, `SSTI Discovery Agent`, `XXE Discovery Agent`

### Client-Side (6 types) → `attacks/client-side/`
- XSS (Reflected/Stored/DOM) | CSRF | Clickjacking
- CORS | Prototype Pollution | DOM-based
**Agent**: `XSS Discovery Agent`, `Prototype Pollution Agent`

### Server-Side (6 types) → `attacks/server-side/`
- SSRF | HTTP Smuggling | Path Traversal
- File Upload | Deserialization | Host Header Injection
**Agent**: `SSRF Discovery Agent`, `Path Traversal Discovery Agent`

### Authentication (4 types) → `attacks/authentication/`
- Bypass | JWT | OAuth | Password Attacks (2FA)
**Agent**: `JWT Attack Discovery Agent`, `/authenticating` skill

### API Security (4 types) → `attacks/api-security/`
- GraphQL | REST API | WebSockets | Web LLM
**Agent**: `/ai-threat-testing` skill for LLM, specialized API agents

### Web Applications (6 types) → `attacks/web-applications/`
- Business Logic | Race Conditions | Access Control
- Cache Poisoning | Cache Deception | Info Disclosure

### Cloud & Containers (5 types) → `attacks/cloud-containers/`
- AWS | Azure | GCP | Docker | Kubernetes

### System (3 types) → `attacks/system/`
- Active Directory | Privilege Escalation | Exploit Development

### Network (5 types) → `attacks/network/`
- DNS Attacks | MITM | Scanning | Sniffing | Wireless

### Physical & Social (1 type) → `attacks/physical-social/`
- Social Engineering

## Per-Attack Documentation Structure

Each attack type folder contains:
- `quickstart.md` - Immediate test vectors
- `cheat-sheet.md` - Common payloads & bypass techniques
- `portswigger-labs-complete.md` - Lab walkthroughs
- `definition.md` - Attack theory & impact
- `methodology.md` - Systematic testing approach
- `resources.md` - Tools, references, advanced techniques

## Orchestration Workflow

**User invokes**: `/pentest` or mentions pentesting
**Pentester agent**:
1. Reads target scope & requirements
2. Selects attack categories (e.g., Injection + Client-Side)
3. **Deploys specialized agents** (SQL Injection Agent, XSS Agent)
4. Aggregates findings into pentest-report.json

**This skill provides**: Attack indexes, documentation paths, methodology guidance

## Output Structure

**Specialized agents output**:
```
outputs/{engagement}/activity/{agent-name}.log    # NDJSON: {"timestamp":"...", "agent":"...", "action":"...", "result":"..."}
outputs/{engagement}/findings/finding-001/        # PoC, evidence, workflow
    ├── poc.py              # Automated exploit
    ├── poc_output.txt      # Execution proof
    ├── workflow.md         # Manual steps
    ├── description.md      # Vuln details + impact
    └── evidence/           # Screenshots, HTTP logs
```

**Pentester coordinator output**:
```
outputs/{engagement}/pentest-report.json          # {"summary": {"critical": N, "high": N, ...}, "findings": [...]}
```

## Methodologies

**PTES** - 7-phase engagement lifecycle (Pre-engagement → Intelligence → Threat modeling → Vulnerability analysis → Exploitation → Post-exploitation → Reporting)

**OWASP WSTG** - 11 testing categories (Info gathering → Config mgmt → Identity mgmt → Auth → Authorization → Session → Input validation → Error handling → Cryptography → Business logic → Client-side)

**MITRE ATT&CK** - TTP mapping across 14 phases (Reconnaissance → Impact)

**Flaw Hypothesis** - Stack analysis → Predict vulnerabilities → Test → Generalize → Correlate

See `/AGENTS.md` for methodology details.

## Playwright Automation

Primary evidence capture tool. Used by specialized agents.

[Guide: `attacks/essential-skills/playwright-automation.md`]

## Integration

- `/authenticating` - Authentication testing workflows
- `/ai-threat-testing` - LLM vulnerability testing
- `/hackerone` - Bug bounty submission automation
- Pentester agent - Multi-phase coordination

## Critical Rules

**Orchestration only** - Never execute attacks directly
**Delegate execution** - Deploy specialized agents for testing
**Documentation index** - Reference attack folders for techniques
**Working PoCs required** - Specialized agents must provide evidence
**Activity logging** - All agents log actions to NDJSON activity logs
